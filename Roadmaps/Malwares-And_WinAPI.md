### **Do Malwares Use Windows API?**  
‚úÖ **Most Windows malware heavily relies on the Windows API (WinAPI) to perform its tasks.** Since Windows operates in **Protected Mode**, malware can't directly interact with hardware or memory like in Real Mode (DOS). Instead, it must use WinAPI functions to achieve its goals.  

---

## **üîπ How Malware Uses Windows API**
### **1Ô∏è‚É£ Process Manipulation (Hiding, Injecting, Running)**
- **`CreateProcessA` / `CreateProcessW`** ‚Üí Spawn new processes  
- **`OpenProcess`** ‚Üí Access another running process  
- **`TerminateProcess`** ‚Üí Kill other processes  
- **`CreateRemoteThread`** ‚Üí Inject code into another process  
- **`WriteProcessMemory`** ‚Üí Modify memory of another process (used in **DLL injection**)  
- **`NtSuspendProcess` / `NtResumeProcess`** ‚Üí Freeze and resume processes (stealth techniques)  

### **2Ô∏è‚É£ File and Registry Manipulation (Persistence)**
- **`CreateFileA` / `WriteFile`** ‚Üí Write malicious payloads to disk  
- **`MoveFileEx`** ‚Üí Rename or replace system files  
- **`RegCreateKeyEx` / `RegSetValueEx`** ‚Üí Add persistence in registry (`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run`)  
- **`DeleteFileA`** ‚Üí Delete logs, evidence of execution  

### **3Ô∏è‚É£ DLL Injection and Hooking (Hiding Itself)**
- **`LoadLibraryA` / `GetProcAddress`** ‚Üí Dynamically load malicious DLLs  
- **`SetWindowsHookExA`** ‚Üí Hook keyboard/mouse events (keyloggers)  
- **`NtWriteVirtualMemory`** ‚Üí Modify memory in another process (Process Hollowing)  

### **4Ô∏è‚É£ Network Communication (Command & Control)**
- **`WinInet.dll` (`InternetOpenUrlA`, `HttpSendRequestA`)** ‚Üí Connect to malicious servers  
- **`WSAStartup` / `connect`** ‚Üí Use raw sockets for botnet control  
- **`GetAdaptersInfo`** ‚Üí Get network adapter details (fingerprinting)  

### **5Ô∏è‚É£ Stealth & Evasion (Bypassing Security)**
- **`NtQuerySystemInformation`** ‚Üí Enumerate running processes to detect antivirus  
- **`IsDebuggerPresent` / `CheckRemoteDebuggerPresent`** ‚Üí Detect if being debugged  
- **`VirtualProtect`** ‚Üí Change memory protections (self-modifying code)  
- **`ZwUnmapViewOfSection`** ‚Üí Unmap and replace a process in memory (**Process Hollowing**)  
- **Direct Syscalls (Bypassing AVs & EDRs)** ‚Üí Use `syscall` instead of `WinAPI` to avoid detection  

---

## **üîπ Malware Categories & Their API Usage**
| **Malware Type** | **API Used** | **Purpose** |
|-----------------|-------------|------------|
| **RAT (Remote Access Trojan)** | `CreateProcessA`, `InternetOpenUrlA` | Executes remote commands, communicates with C2 server |
| **Ransomware** | `CryptEncrypt`, `WriteFile`, `MoveFileEx` | Encrypts files, modifies boot sector |
| **Keylogger** | `SetWindowsHookExA`, `WriteFile` | Logs keystrokes and stores them |
| **Rootkit** | `NtQuerySystemInformation`, `ZwWriteVirtualMemory` | Hides processes, manipulates kernel memory |
| **Stealer (Info Stealer)** | `ReadProcessMemory`, `HttpSendRequestA` | Extracts passwords, browser data |
| **Process Hollowing** | `ZwUnmapViewOfSection`, `WriteProcessMemory` | Replaces legit process with malicious code |

---

## **üîπ How Malware Avoids Detection**
üíÄ **Hackers avoid using direct WinAPI calls because modern antiviruses monitor them. Instead, they use:**  
‚úÖ **Syscalls (Direct Kernel Calls)** ‚Üí Bypasses AV/EDR hooking WinAPI  
‚úÖ **Dynamic Function Resolution (`LoadLibraryA`, `GetProcAddress`)** ‚Üí Loads APIs at runtime  
‚úÖ **Code Injection (Process Hollowing, Reflective DLL Injection)** ‚Üí Runs malicious code inside legitimate processes  

---

### **üìå TL;DR**
- ‚úÖ **Yes, malware uses WinAPI to perform all malicious tasks (process injection, registry edits, network communication, etc.).**  
- üî• **Modern malware avoids direct API calls and uses syscalls, function obfuscation, and process injection to bypass detection.**  
- ‚ö†Ô∏è **If you're learning malware analysis or development, understanding Windows API is critical!**  

